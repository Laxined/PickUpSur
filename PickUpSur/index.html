<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PickUpSur</title>
</head>
<style>
     .mid {
        display: block;
        margin: 28%;
        margin-top: 0%;
        margin-bottom: 0%;
    }

    canvas {
     background-color: grey;;
    }

    h1 {
     text-align: center;
      font-size: 350%;
    }
</style>
<body>

    <h1>To do</h1>
    <div class="mid">
    <canvas id="myCanvas" width="800" height="800" style="border:5px solid black">
        Your browser does not support the canvas element.
    </canvas>
    </div>
</body>
<script>
      var canvas = document.getElementById("myCanvas");
      var ctx = canvas.getContext("2d");

      window.addEventListener('keydown', this.onKey, false);
    

      let posX = 400;
      let posY = 400;
      let plSizeX = 60;
      let plSizeY = 30;
      let speed = 10;

        let npcList = [
			newNPC(700, 50, 75, 75, "red")
		]

        function newNPC(x, y, szX, szY, sk) {
                return {x: x, y: y, szX: szX, szY: szY, sk: sk}
        }

        let enemyList = [
            newEnemy(20, 20, 83, 50, false, Math.PI * 2 * Math.random(), "black", 5)
        ]

        function newEnemy(x, y, szX, szY, fr, ang, sk, sp) {
            return {x: x, y: y, szX: szX, szY: szY, fr: fr, ang: ang, sk: sk, sp:sp}
        }

        let stillEnemyList = [
            newStillEnemy(0, 550, 83, 50, 2, "black"),
            newStillEnemy(500, 550, 83, 50, 2, "black"),
        ]

        function newStillEnemy(x, y, sx, sy, sp, sk) {
            return {x:x, y:y, sx:sx, sy:sy, sp:sp, sk:sk}
        }

      function onKey(event) {
            if (event.keyCode == 65 || event.keyCode == 37) {
                posX -= speed;
            }
            if (event.keyCode == 68 || event.keyCode == 39) {
                posX += speed;
            }
			if (event.keyCode == 87 || event.keyCode == 38) {
			posY -= speed;
			}
			if (event.keyCode == 83 || event.keyCode == 40) {
			posY += speed;
			}

			if (posY < 0){
			posY += speed;
			}
			if (posY + plSizeY >= 805) {
			posY -= speed;
			}
			if (posX < 0) {
			posX += speed;
			}
			if (posX + plSizeX >= 805) {
			posX -= speed;
			}

        }
    function draw() {
        ctx.clearRect(0, 0, canvas.clientWidth, canvas.clientHeight);

        enemyMovement();
        stillEnemyMovement();

        ctx.fillStyle = "red";
        ctx.fillRect(posX, posY, plSizeX, plSizeY);

        for (npc of npcList) {
            ctx.fillStyle = npc.sk;
            ctx.fillRect(npc.x, npc.y, npc.szX, npc.szY);
        }

        for (stillEnemy of stillEnemyList) {
            ctx.fillStyle = stillEnemy.sk;
            ctx.fillRect(stillEnemy.x, stillEnemy.y, stillEnemy.sx, stillEnemy.sy);
        }
        for (enemy of enemyList) {
            ctx.fillStyle = enemy.sk;
            ctx.fillRect(enemy.x, enemy.y, enemy.szX, enemy.szY);
        }
    }


    function enemyMovement() {
        for (enemy of enemyList) {
            enemy.x += Math.cos(enemy.ang) * enemy.sp;
            enemy.y += Math.sin(enemy.ang) * enemy.sp;

            if (Math.random() < 0.05) enemy.ang = Math.random() * Math.PI * 2;

            if (enemy.x <= 0) enemy.x = -enemy.x;
            if (enemy.x + enemy.szX >= 800) enemy.x = -enemy.x;

            if (enemy.y <= 0) enemy.y = -enemy.y;
            if (enemy.y + enemy.szY >= 800) enemy.y = -enemy.y;

        }
    }

    function stillEnemyMovement() {
        for (stillEnemy of stillEnemyList) {
            stillEnemy.x += stillEnemy.sp;
        }

        if (stillEnemy.x >= 802) stillEnemy.x = 0;
    }
    setInterval(draw, 15);
</script>
</html>